
<style type="text/css">
	* {
		padding: 0;
		margin: 0;
		height: 100%;
		width: 100%;
		vertical-align: top;
	}

	#test-main {
		width: 500px;
		height: 500px;
	}

	#test-secondary {
		display: none;
	}

	canvas {
		display: block;
		position: fixed;
		height: 500px;
		width: 500px;
		top: 0;
		right: 0;
		bottom: 0;
		left: 0;
		margin: auto;

		border: 1px solid #000;
	}
</style>
<script type="text/javascript" src="../../index.js"></script>
<script type="text/javascript">
	window.onload = function () {
		// var {Canvas, Item, animator} = _13kb;

		var Canvas = _13kb.Canvas;

		var Item = _13kb.Item;

		var animator = _13kb.animator;

		var canvas = new Canvas(document.body, {width: 500, height: 500});

		var context = canvas.context;

		var img = new Image();

		img.src = './4.png';

		var props = {
			frames: [
				{x1: 12, y1: 0, x2: 108, y2: 145, x_shift: 0, y_shift: 0},
				{x1: 110, y1: 0, x2: 180, y2: 145, x_shift: 0, y_shift: 0},
				{x1: 197, y1: 0, x2: 247, y2: 145, x_shift: 0, y_shift: 0},
				{x1: 266, y1: 0, x2: 336, y2: 145, x_shift: 0, y_shift: 0},
				{x1: 341, y1: 0, x2: 413, y2: 145, x_shift: 0, y_shift: 0}
			]
		};

		var draw = (function () {
			var index = 0;

			return function (context, x, y, frames) {
				var frames = frames.frames;

				frames = frames[(index++) % frames.length];

				// var {x1, x2, y1, y2, x_shift, y_shift} = frames[(index++) % frames.length];

				var x1 = frames.x1, x2 = frames.x2, y1 = frames.y1, y2 = frames.y2, x_shift = frames.x_shift, y_shift = frames.y_shift;

				var w = x2 - x1;
				var h = y2 - y1;

				context.drawImage(img, x1, y1, w, h, x + x_shift, y + y_shift, w, h);
			};
		})();

		img.addEventListener('load', function (event)  {
			canvas.addFragment(new Item('girl', draw, 0, 0, props));

			animator((function () {
				var prevAlpha = -1;
				return function (alpha) {
					alpha = alpha >> 0;

					if (alpha <= prevAlpha)
						return;

					prevAlpha = alpha;

					canvas.distClear().redraw();

				}
			})(), 8);
		}, false);
	}
</script>